<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Push-Up Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#060b14;
  --card:#0f1d34;
  --border:rgba(255,255,255,.08);
  --text:#e6eefc;
  --muted:#9fb0d0;
  --green:#31d07c;
  --amber:#f5b942;
  --blue:#2b66ff;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui;
  background:radial-gradient(1200px 600px at 50% -200px,#101a30 0%,var(--bg) 55%);
  color:var(--text);
}
header{
  padding:20px;
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
}
h1,h2{margin:0 0 10px}
button,input{
  background:var(--blue);
  color:#fff;
  border:none;
  border-radius:14px;
  padding:8px 12px;
}
.grid{
  padding:16px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:14px;
}
.card{
  background:linear-gradient(180deg,#0f1d34,#0b1527);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
}
.label{color:var(--muted);font-size:12px}
.value{font-size:32px;font-weight:800;color:var(--green)}
.section{padding:16px}
canvas{
  width:100%;
  background:#070c17;
  border-radius:16px;
  border:1px solid var(--border);
}
.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:8px;
}
.day{
  height:64px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#0a1222;
  padding:6px;
  position:relative;
  cursor:pointer;
}
.day .num{font-size:11px;color:var(--muted)}
.day .sum{position:absolute;right:6px;bottom:6px;font-weight:800}
.progress{
  height:10px;
  border-radius:10px;
  background:#111;
  overflow:hidden;
}
.progress > div{
  height:100%;
  background:var(--green);
}
.badge{
  padding:8px 10px;
  border-radius:12px;
  background:#0a1222;
  border:1px solid var(--border);
  opacity:.4;
}
.badge.unlocked{
  opacity:1;
  background:rgba(49,208,124,.15);
  border-color:rgba(49,208,124,.5);
}
footer{
  padding:10px 16px;
  font-size:12px;
  color:var(--muted);
}
</style>
</head>

<body>

<header>
  <h1>Push-Up Dashboard</h1>
  <button onclick="loadData()">ğŸ”„ Refresh</button>
</header>

<section class="grid">
  <div class="card"><div class="label">TOTAL REPS</div><div class="value" id="totalReps">â€”</div></div>
  <div class="card"><div class="label">WORKOUTS</div><div class="value" id="workouts">â€”</div></div>
  <div class="card"><div class="label">BEST DAY</div><div class="value" id="bestDay">â€”</div></div>
  <div class="card"><div class="label">BEST WEEK</div><div class="value" id="bestWeek">â€”</div></div>
</section>

<section class="section">
  <h2>ğŸ¯ Daily Goal</h2>
  <input type="number" id="goalInput" placeholder="Daily reps" />
  <button onclick="saveGoal()">Save</button>
  <div class="progress" style="margin-top:10px">
    <div id="goalBar"></div>
  </div>
  <div id="goalText" class="label"></div>
</section>

<section class="section">
  <h2>ğŸ“Š Weekly Volume Trend</h2>
  <canvas id="trend" height="240"></canvas>
</section>

<section class="section">
  <h2>ğŸ“… Calendar</h2>
  <div class="calendar" id="calendar"></div>
  <div id="dayDetails" class="label"></div>
</section>

<section class="section">
  <h2>ğŸ† Achievements</h2>
  <div class="grid" id="achievements"></div>
</section>

<footer id="status">Idle</footer>

<script>
const DATA_URL="https://script.google.com/macros/s/AKfycbxCYLXUKDsKNGhHUQzh_135yHk0j5lZ9JJZdJpxGiOEu66HndjWqQMWRBd7XZBIpCec/exec";
let data=[],goal=Number(localStorage.goal)||50;

document.getElementById("goalInput").value=goal;

function saveGoal(){
  goal=Number(goalInput.value||50);
  localStorage.goal=goal;
  render();
}

function loadData(){
 fetch(DATA_URL+"?t="+Date.now())
 .then(r=>r.json())
 .then(j=>{data=j;render();});
}

function render(){
 const total=data.reduce((s,r)=>s+r.reps,0);
 totalReps.textContent=total;
 workouts.textContent=data.length;

 const byDay={},byWeek={};
 data.forEach(r=>{
  byDay[r.date]=(byDay[r.date]||0)+r.reps;
  const d=new Date(r.date+"T00:00");
  d.setDate(d.getDate()-(d.getDay()+6)%7);
  const w=d.toISOString().slice(0,10);
  byWeek[w]=(byWeek[w]||0)+r.reps;
 });

 bestDay.textContent=Math.max(...Object.values(byDay));
 bestWeek.textContent=Math.max(...Object.values(byWeek));

 renderGoal(byDay);
 drawCalendar(byDay);
 drawTrend(byWeek);
 renderAchievements(total);

 status.textContent="Updated";
}

function renderGoal(byDay){
 const today=new Date().toISOString().slice(0,10);
 const v=byDay[today]||0;
 goalBar.style.width=Math.min(v/goal*100,100)+"%";
 goalText.textContent=`${v} / ${goal} reps`;
}

function drawCalendar(byDay){
 calendar.innerHTML="";
 dayDetails.textContent="";
 const d=new Date(),y=d.getFullYear(),m=d.getMonth();
 const days=new Date(y,m+1,0).getDate();
 for(let i=1;i<=days;i++){
  const iso=`${y}-${String(m+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`;
  const v=byDay[iso]||0;
  const el=document.createElement("div");
  el.className="day";
  el.style.background=`rgba(49,208,124,${Math.min(v/100,.6)})`;
  el.innerHTML=`<div class="num">${i}</div><div class="sum">${v||""}</div>`;
  el.onclick=()=>dayDetails.textContent=`${iso}: ${v} reps`;
  calendar.appendChild(el);
 }
}

function drawTrend(byWeek){
 const c=trend,x=c.getContext("2d");
 x.clearRect(0,0,c.width,c.height);
 const e=Object.entries(byWeek).sort((a,b)=>a[0].localeCompare(b[0])).slice(-8);
 if(e.length<2)return;
 const v=e.map(i=>i[1]);
 const max=Math.max(...v),min=Math.min(...v);
 const improving=v[v.length-1]>=v[0];
 x.strokeStyle=improving?"#31d07c":"#f5b942";
 x.lineWidth=3;
 x.beginPath();
 v.forEach((n,i)=>{
  const px=i*(c.width/(v.length-1));
  const py=c.height-((n-min)/(max-min||1))*c.height;
  i?x.lineTo(px,py):x.moveTo(px,py);
 });
 x.stroke();
}

function renderAchievements(total){
 const milestones=[500,1000,2500,5000];
 achievements.innerHTML="";
 milestones.forEach(m=>{
  const d=document.createElement("div");
  d.className="badge"+(total>=m?" unlocked":"");
  d.textContent=`${m} reps`;
  achievements.appendChild(d);
 });
}

loadData();
</script>
</body>
</html>
