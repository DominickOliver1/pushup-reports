<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Push-Up Performance</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<style>
:root{
  --bg:#050812;
  --panel:#0b1426;
  --card:#0f1d34;
  --border:rgba(255,255,255,.08);
  --text:#eaf1ff;
  --muted:#9fb0d0;
  --green:#31d07c;
  --amber:#f5b942;
  --blue:#2b66ff;
  --glow:0 0 24px rgba(49,208,124,.25);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:
    radial-gradient(800px 400px at 50% -200px,#0e1b36 0%,var(--bg) 55%);
  color:var(--text);
}

/* HEADER */
header{padding:22px}
header h1{margin:0;font-size:26px}
.sub{margin-top:6px;color:var(--muted);font-size:13px}
button{
  background:linear-gradient(180deg,#3a7bff,#2b66ff);
  color:#fff;
  border:none;
  border-radius:14px;
  padding:10px 16px;
  font-weight:600;
  margin-top:10px;
}

/* LAYOUT */
.section{padding:0 16px;margin-top:20px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px}

/* CARDS */
.card{
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(0,0,0,.1)),var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
  box-shadow:0 10px 35px rgba(0,0,0,.45);
}
.label{color:var(--muted);font-size:11px;letter-spacing:.12em}
.value{margin-top:8px;font-size:32px;font-weight:800;color:var(--green)}

/* GOAL */
.progress{height:12px;background:#070c17;border-radius:12px;overflow:hidden}
.progress div{
  height:100%;
  background:linear-gradient(90deg,#31d07c,#3cff9d);
  box-shadow:var(--glow);
  transition:width .3s;
}

/* CALENDAR */
.calendar-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
.day{
  height:64px;
  border-radius:14px;
  border:1px solid var(--border);
  background:#081020;
  padding:6px;
  position:relative;
}
.day .num{font-size:11px;color:var(--muted)}
.day .sum{position:absolute;right:6px;bottom:6px;font-weight:800}

/* STREAK */
.streak-bar{display:flex;gap:6px;margin-top:10px}
.streak-dot{
  width:12px;height:12px;border-radius:50%;
  background:#0a1222;border:1px solid var(--border)
}
.streak-dot.active{background:var(--green);box-shadow:var(--glow)}

/* ACHIEVEMENTS */
.badge{
  background:#070c17;
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  text-align:center;
  opacity:.35;
}
.badge.unlocked{
  opacity:1;
  background:linear-gradient(180deg,rgba(49,208,124,.18),rgba(0,0,0,.15));
  border-color:rgba(49,208,124,.5);
  box-shadow:var(--glow);
}
.badge .big{font-size:22px;font-weight:800;color:var(--green)}

footer{margin:20px 16px;color:var(--muted);font-size:12px}
</style>
</head>

<body>

<header>
  <h1>Push-Up Performance</h1>
  <div class="sub">Live ‚Ä¢ Read-only ‚Ä¢ Installable</div>
  <button onclick="loadData()">Refresh</button>
  <button onclick="copyStats()">Copy Stats</button>
</header>

<section class="section grid">
  <div class="card"><div class="label">TOTAL REPS</div><div class="value" id="totalReps">‚Äî</div></div>
  <div class="card"><div class="label">WORKOUTS</div><div class="value" id="workouts">‚Äî</div></div>
  <div class="card"><div class="label">BEST DAY</div><div class="value" id="bestDay">‚Äî</div></div>
  <div class="card"><div class="label">BEST WEEK</div><div class="value" id="bestWeek">‚Äî</div></div>
</section>

<section class="section">
  <h2>üî• Streak</h2>
  <div class="label" id="streakText"></div>
  <div class="streak-bar" id="streakBar"></div>
</section>

<section class="section">
  <h2>üéØ Daily Goal</h2>
  <div class="progress"><div id="goalBar"></div></div>
  <div class="sub" id="goalText"></div>
</section>

<section class="section">
  <h2>üìÖ Calendar</h2>
  <div class="calendar-nav">
    <button onclick="changeMonth(-1)">‚óÄ</button>
    <div id="monthLabel"></div>
    <button onclick="changeMonth(1)">‚ñ∂</button>
  </div>
  <div class="calendar" id="calendar"></div>
  <div class="sub" id="dayDetails"></div>
</section>

<section class="section">
  <h2>üèÜ Achievements</h2>
  <div class="grid" id="achievements"></div>
</section>

<footer id="status">Idle</footer>

<script>
const DATA_URL="https://script.google.com/macros/s/AKfycbxCYLXUKDsKNGhHUQzh_135yHk0j5lZ9JJZdJpxGiOEu66HndjWqQMWRBd7XZBIpCec/exec";
let data=[],currentMonth=new Date(),goal=Number(localStorage.goal)||50;

function loadData(){
 fetch(DATA_URL+"?t="+Date.now())
 .then(r=>r.json())
 .then(j=>{data=j;render();});
}

function render(){
 const byDay={},byWeek={};
 data.forEach(r=>{
  byDay[r.date]=(byDay[r.date]||0)+r.reps;
  const d=new Date(r.date+"T00:00");
  d.setDate(d.getDate()-(d.getDay()+6)%7);
  byWeek[d.toISOString().slice(0,10)]=(byWeek[d.toISOString().slice(0,10)]||0)+r.reps;
 });

 totalReps.textContent=data.reduce((s,r)=>s+r.reps,0);
 workouts.textContent=data.length;
 bestDay.textContent=Math.max(...Object.values(byDay));
 bestWeek.textContent=Math.max(...Object.values(byWeek));

 renderStreak(byDay);
 renderGoal(byDay);
 renderCalendar(byDay);
 renderAchievements(totalReps.textContent);
 status.textContent="Updated";
}

function renderStreak(byDay){
 const days=Object.keys(byDay).sort();
 let current=0,max=0;
 for(let i=0;i<days.length;i++){
  if(i>0 && new Date(days[i])-new Date(days[i-1])===86400000) current++;
  else current=1;
  max=Math.max(max,current);
 }
 streakText.textContent=`Current: ${current} days ‚Ä¢ Longest: ${max}`;
 streakBar.innerHTML="";
 for(let i=0;i<max;i++){
  const d=document.createElement("div");
  d.className="streak-dot"+(i<current?" active":"");
  streakBar.appendChild(d);
 }
}

function renderGoal(byDay){
 const today=new Date().toISOString().slice(0,10);
 const v=byDay[today]||0;
 goalBar.style.width=Math.min(v/goal*100,100)+"%";
 goalText.textContent=`${v} / ${goal} reps today`;
}

function renderCalendar(byDay){
 calendar.innerHTML="";
 dayDetails.textContent="";
 const y=currentMonth.getFullYear(),m=currentMonth.getMonth();
 monthLabel.textContent=currentMonth.toLocaleString("default",{month:"long",year:"numeric"});
 const days=new Date(y,m+1,0).getDate();
 for(let i=1;i<=days;i++){
  const iso=`${y}-${String(m+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`;
  const v=byDay[iso]||0;
  const el=document.createElement("div");
  el.className="day";
  el.style.background=`rgba(49,208,124,${Math.min(v/100,.6)})`;
  el.innerHTML=`<div class="num">${i}</div><div class="sum">${v||""}</div>`;
  el.onclick=()=>dayDetails.textContent=`${iso}: ${v} reps`;
  calendar.appendChild(el);
 }
}

function changeMonth(d){currentMonth.setMonth(currentMonth.getMonth()+d);renderCalendar({});render();}

function renderAchievements(total){
 achievements.innerHTML="";
 [500,1000,2500,5000,10000].forEach(m=>{
  const b=document.createElement("div");
  b.className="badge"+(total>=m?" unlocked":"");
  b.innerHTML=`<div class="big">${m}</div><div class="label">Total Reps</div>`;
  achievements.appendChild(b);
 });
}

function copyStats(){
 const text=`Push-Up Stats:
Total Reps: ${totalReps.textContent}
Workouts: ${workouts.textContent}
Best Day: ${bestDay.textContent}
Best Week: ${bestWeek.textContent}`;
 navigator.clipboard.writeText(text);
 alert("Stats copied!");
}

loadData();
</script>
</body>
</html>