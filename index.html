<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Push-Up Reports</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, sans-serif;
  background: #0b1220;
  color: #e7eefc;
}
header {
  padding: 20px;
}
h1 { margin: 0; }
button {
  background: #2b66ff;
  border: none;
  color: white;
  padding: 10px 14px;
  border-radius: 10px;
  font-size: 14px;
  cursor: pointer;
}
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 12px;
  padding: 16px;
}
.card {
  background: #14233b;
  border-radius: 14px;
  padding: 16px;
}
.label {
  color: #9fb0d0;
  font-size: 12px;
}
.value {
  font-size: 36px;
  font-weight: bold;
  color: #28d17c;
}
.history {
  padding: 16px;
}
.item {
  background: #14233b;
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 10px;
}
.item strong {
  font-size: 22px;
  color: #28d17c;
}
footer {
  padding: 10px 16px;
  color: #9fb0d0;
  font-size: 12px;
}
</style>
</head>

<body>

<header>
  <h1>Reports & Stats</h1>
  <button onclick="loadData()">ðŸ”„ Refresh Data</button>
</header>

<section class="grid">
  <div class="card">
    <div class="label">TOTAL WORKOUTS</div>
    <div class="value" id="workouts">â€”</div>
  </div>
  <div class="card">
    <div class="label">TOTAL REPS</div>
    <div class="value" id="totalReps">â€”</div>
  </div>
  <div class="card">
    <div class="label">AVG REPS / SESSION</div>
    <div class="value" id="avgSession">â€”</div>
  </div>
  <div class="card">
    <div class="label">BEST SESSION</div>
    <div class="value" id="bestSession">â€”</div>
  </div>
  <div class="card">
    <div class="label">DAILY AVG REPS</div>
    <div class="value" id="dailyAvg">â€”</div>
  </div>
  <div class="card">
    <div class="label">WEEKLY AVG REPS</div>
    <div class="value" id="weeklyAvg">â€”</div>
  </div>
</section>

<section class="history">
  <h2>Activity History</h2>
  <div id="history"></div>
</section>

<footer id="status">Idle</footer>

<script>
// ðŸ”´ https://script.google.com/macros/s/AKfycbxCYLXUKDsKNGhHUQzh_135yHk0j5lZ9JJZdJpxGiOEu66HndjWqQMWRBd7XZBIpCec/exec
const DATA_URL = "https://script.google.com/macros/s/AKfycbxCYLXUKDsKNGhHUQzh_135yHk0j5lZ9JJZdJpxGiOEu66HndjWqQMWRBd7XZBIpCec/exec";

async function loadData() {
  document.getElementById("status").textContent = "Loading...";
  const res = await fetch(DATA_URL + "?t=" + Date.now());
  const data = await res.json();

  const totalReps = data.reduce((s, r) => s + r.reps, 0);
  const workouts = data.length;
  const avgSession = workouts ? (totalReps / workouts).toFixed(1) : 0;

  const byDay = {};
  data.forEach(r => byDay[r.date] = (byDay[r.date] || 0) + r.reps);
  const days = Object.keys(byDay).length;
  const dailyAvg = days ? (totalReps / days).toFixed(1) : 0;

  const byWeek = {};
  data.forEach(r => {
    const d = new Date(r.date);
    const week = `${d.getFullYear()}-W${Math.ceil(d.getDate()/7)}`;
    byWeek[week] = (byWeek[week] || 0) + r.reps;
  });
  const weeklyAvg = Object.values(byWeek).length
    ? (totalReps / Object.values(byWeek).length).toFixed(1)
    : 0;

  const best = Math.max(...data.map(r => r.reps), 0);

  document.getElementById("workouts").textContent = workouts;
  document.getElementById("totalReps").textContent = totalReps;
  document.getElementById("avgSession").textContent = avgSession;
  document.getElementById("bestSession").textContent = best;
  document.getElementById("dailyAvg").textContent = dailyAvg;
  document.getElementById("weeklyAvg").textContent = weeklyAvg;

  const history = document.getElementById("history");
  history.innerHTML = "";
  data.slice().reverse().slice(0, 20).forEach(r => {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `<strong>${r.reps} Reps</strong><br>${r.date}`;
    history.appendChild(div);
  });

  document.getElementById("status").textContent = `Loaded ${workouts} workouts`;
}

loadData();
</script>

</body>
</html>
